# ステージングリリース PR 作成

## 目的

develop ブランチから staging-dog ブランチへのリリース PR を作成する

## 実行手順

1. **ツール選択**

   - GitHub の MCP ツールが利用可能か確認
   - 利用不可の場合は gh コマンドを使用

2. **ブランチ存在確認**

   - MCP ツール利用時: GitHub の MCP ツールでリモートリポジトリのブランチ一覧を取得
   - gh コマンド利用時: `git ls-remote --heads origin` でブランチ一覧を取得
   - develop ブランチが存在しない場合:
     → 「develop ブランチが存在しません」と通知して終了
   - staging-dog ブランチが存在しない場合:
     → 「staging-dog ブランチが存在しません」と通知して終了

3. **差分とコミット履歴の取得**

   - MCP ツール利用時: GitHub の MCP ツールでコミット履歴と詳細を取得
   - gh コマンド利用時: `git log origin/staging-dog..origin/develop` でコミット履歴を取得
   - staging-dog ブランチと develop ブランチの差分を特定
   - 変更内容を分析

4. **リリース内容の生成**

   - 取得した差分とコミットメッセージから以下を日本語で作成:
     - タイトル: 「[Staging] YYYY-MM-DD リリース」形式
     - 本文:
       - リリース日時
       - 主な変更点(機能追加、バグ修正、改善に分類)
       - 影響範囲
       - デプロイ後の確認項目(ある場合)
   - 感情表現や装飾表現は排除し、事実のみ記載

5. **PR 作成**

   - MCP ツール利用時: GitHub の MCP ツールでプルリクエストを作成
   - gh コマンド利用時: `gh pr create --base staging-dog --head develop --title [タイトル] --body [本文]`

6. **結果通知**
   - PR URL を出力
   - 作成完了メッセージのみ表示

## エラーハンドリング

- リポジトリ情報が取得できない → ユーザーに通知して終了
- develop と staging-dog に差分がない → 「差分なし。リリース不要」と通知して終了
- API 権限不足 → エラー内容を明示して終了
- MCP ツールと gh コマンド両方が利用不可 → その旨を通知して終了

## 制約

- 優先順位: GitHub の MCP ツール > gh コマンド
- 全ての出力は日本語
